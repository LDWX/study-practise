html_doc ="""<html xmlns:o="urn:schemas-microsoft-com:office:office"
  xmlns:x="urn:schemas-microsoft-com:office:excel"
  xmlns="http://www.w3.org/TR/REC-html40"><head>
    <meta http-equiv="Content-Type" content="text/html; charset=gb2312">
    <meta name="ProgId" content="Excel.Sheet">
    <meta name="Generator" content="Microsoft Excel 11">
    <link rel="File-List" href="C0205.files/filelist.xml">
    <link rel="Edit-Time-Data" href="C0205.files/editdata.mso">
    <link rel="OLE-Object-Data" href="C0205.files/oledata.mso">

  </head>

  <body link="blue" vlink="purple" marginwidth="10" marginheight="20">

    <table onmouseover="runChgbgColor('MtvTab','5','1')" id="MtvTab" x:str
      border="0" cellpadding="0" cellspacing="0" width="526"
      style="border-collapse:
   collapse;table-layout:fixed;width:396pt">
      <colgroup><col width="90"
          style="mso-width-source:userset;mso-width-alt:2880;width:68pt">
        <col width="109" span="4"
          style="mso-width-source:userset;mso-width-alt:3488;
   width:82pt">
      </colgroup><tbody><tr height="24"
          style="mso-height-source:userset;height:18.0pt">
          <td colspan="5" height="24" class="xl72" width="526"
            style="height:18.0pt;width:396pt">表2.5
            各区户籍人口迁移（2021～2022）</td>
        </tr>
        <tr height="19" style="mso-height-source:userset;height:14.25pt">
          <td colspan="5" height="19" class="xl72" width="526"
            style="height:14.25pt;
    width:396pt"></td>
        </tr>
        <tr height="19" style="mso-height-source:userset;height:14.25pt">
          <td colspan="5" height="19" class="xl74" width="526"
            style="height:14.25pt;
    width:396pt">单位：人</td>
        </tr>
        <tr height="19" style="height:14.25pt">
          <td rowspan="2" height="38" class="xl70" width="90"
            style="border-bottom:.5pt solid black;
    height:28.5pt;border-top:none;width:68pt"
            x:str="地  区                                                                                                  ">地<span
              style="mso-spacerun:yes">&nbsp; </span>区</td>
          <td colspan="2" class="xl77" x:num>2021</td>
          <td colspan="2" class="xl78" width="218" style="width:164pt"
            x:num>2022</td>
        </tr>
        <tr height="19" style="height:14.25pt">
          <td height="19" class="xl69" style="height:14.25pt">市外迁入</td>
          <td class="xl69">迁往市外</td>
          <td class="xl69">市外迁入</td>
          <td class="xl69">迁往市外</td>
        </tr>
        <tr height="19" style="height:14.25pt">
          <td height="19" class="xl67" style="height:14.25pt">全<span
              style="mso-spacerun:yes">&nbsp; </span>市</td>
          <td class="xl68" x:num="265934"><span
              style="mso-spacerun:yes">&nbsp;</span>265
            934</td>
          <td class="xl68" x:num="28401"><span
              style="mso-spacerun:yes">&nbsp;</span>28
            401</td>
          <td class="xl68" x:num="211679"><span
              style="mso-spacerun:yes">&nbsp;</span>211
            679</td>
          <td class="xl68" x:num="23954"><span
              style="mso-spacerun:yes">&nbsp;</span>23
            954</td>
        </tr>
        <tr height="19" style="height:14.25pt">
          <td height="19" class="xl65" style="height:14.25pt">
            <span style="mso-spacerun:yes">&nbsp; </span>
            浦东新区
          </td>
          <td class="xl66" x:num="75390"><span style="mso-spacerun:yes">&nbsp;</span>75 390</td>
          <td class="xl66" x:num="4554"><span
              style="mso-spacerun:yes">&nbsp;</span>4 554</td>
          <td class="xl66" x:num="61476"><span
              style="mso-spacerun:yes">&nbsp;</span>61
            476</td>
          <td class="xl66" x:num="4113"><span
              style="mso-spacerun:yes">&nbsp;</span>4 113</td>
        </tr>
        <tr height="19" style="height:14.25pt">
          <td height="19" class="xl65" style="height:14.25pt"><span
              style="mso-spacerun:yes">&nbsp; </span>黄浦区</td>
          <td class="xl66" x:num="4914"><span
              style="mso-spacerun:yes">&nbsp;</span>4 914</td>
          <td class="xl66" x:num="515"><span style="mso-spacerun:yes">&nbsp;
            </span>515</td>
          <td class="xl66" x:num="3565"><span
              style="mso-spacerun:yes">&nbsp;</span>3 565</td>
          <td class="xl66" x:num="421"><span style="mso-spacerun:yes">&nbsp;
            </span>421</td>
        </tr>
        <tr height="19" style="height:14.25pt">
          <td height="19" class="xl65" style="height:14.25pt"><span
              style="mso-spacerun:yes">&nbsp; </span>徐汇区</td>
          <td class="xl66" x:num="17273"><span
              style="mso-spacerun:yes">&nbsp;</span>17
            273</td>
          <td class="xl66" x:num="4396"><span
              style="mso-spacerun:yes">&nbsp;</span>4 396</td>
          <td class="xl66" x:num="12507"><span
              style="mso-spacerun:yes">&nbsp;</span>12
            507</td>
          <td class="xl66" x:num="3689"><span
              style="mso-spacerun:yes">&nbsp;</span>3 689</td>
        </tr>
        <tr height="19" style="height:14.25pt">
          <td height="19" class="xl65" style="height:14.25pt"><span
              style="mso-spacerun:yes">&nbsp; </span>长宁区</td>
          <td class="xl66" x:num="11183"><span
              style="mso-spacerun:yes">&nbsp;</span>11
            183</td>
          <td class="xl66" x:num="1190"><span
              style="mso-spacerun:yes">&nbsp;</span>1 190</td>
          <td class="xl66" x:num="8030"><span
              style="mso-spacerun:yes">&nbsp;</span>8 030</td>
          <td class="xl66" x:num="874"><span style="mso-spacerun:yes">&nbsp;
            </span>874</td>
        </tr>
        <tr height="19" style="height:14.25pt">
          <td height="19" class="xl65" style="height:14.25pt"><span
              style="mso-spacerun:yes">&nbsp; </span>静安区</td>
          <td class="xl66" x:num="9053"><span
              style="mso-spacerun:yes">&nbsp;</span>9 053</td>
          <td class="xl66" x:num="655"><span style="mso-spacerun:yes">&nbsp;
            </span>655</td>
          <td class="xl66" x:num="7916"><span
              style="mso-spacerun:yes">&nbsp;</span>7 916</td>
          <td class="xl66" x:num="575"><span style="mso-spacerun:yes">&nbsp;
            </span>575</td>
        </tr>
        <tr height="19" style="height:14.25pt">
          <td height="19" class="xl65" style="height:14.25pt"><span
              style="mso-spacerun:yes">&nbsp; </span>普陀区</td>
          <td class="xl66" x:num="11044"><span
              style="mso-spacerun:yes">&nbsp;</span>11
            044</td>
          <td class="xl66" x:num="659"><span style="mso-spacerun:yes">&nbsp;
            </span>659</td>
          <td class="xl66" x:num="8985"><span
              style="mso-spacerun:yes">&nbsp;</span>8 985</td>
          <td class="xl66" x:num="531"><span style="mso-spacerun:yes">&nbsp;
            </span>531</td>
        </tr>
        <tr height="19" style="height:14.25pt">
          <td height="19" class="xl65" style="height:14.25pt"><span
              style="mso-spacerun:yes">&nbsp; </span>虹口区</td>
          <td class="xl66" x:num="5956"><span
              style="mso-spacerun:yes">&nbsp;</span>5 956</td>
          <td class="xl66" x:num="995"><span style="mso-spacerun:yes">&nbsp;
            </span>995</td>
          <td class="xl66" x:num="4717"><span
              style="mso-spacerun:yes">&nbsp;</span>4 717</td>
          <td class="xl66" x:num="820"><span style="mso-spacerun:yes">&nbsp;
            </span>820</td>
        </tr>
        <tr height="19" style="height:14.25pt">
          <td height="19" class="xl65" style="height:14.25pt"><span
              style="mso-spacerun:yes">&nbsp; </span>杨浦区</td>
          <td class="xl66" x:num="19412"><span
              style="mso-spacerun:yes">&nbsp;</span>19
            412</td>
          <td class="xl66" x:num="5684"><span
              style="mso-spacerun:yes">&nbsp;</span>5 684</td>
          <td class="xl66" x:num="14083"><span
              style="mso-spacerun:yes">&nbsp;</span>14
            083</td>
          <td class="xl66" x:num="4649"><span
              style="mso-spacerun:yes">&nbsp;</span>4 649</td>
        </tr>
        <tr height="19" style="height:14.25pt">
          <td height="19" class="xl65" style="height:14.25pt"><span
              style="mso-spacerun:yes">&nbsp; </span>闵行区</td>
          <td class="xl66" x:num="34809"><span
              style="mso-spacerun:yes">&nbsp;</span>34
            809</td>
          <td class="xl66" x:num="2596"><span
              style="mso-spacerun:yes">&nbsp;</span>2 596</td>
          <td class="xl66" x:num="27701"><span
              style="mso-spacerun:yes">&nbsp;</span>27
            701</td>
          <td class="xl66" x:num="2242"><span
              style="mso-spacerun:yes">&nbsp;</span>2 242</td>
        </tr>
        <tr height="19" style="height:14.25pt">
          <td height="19" class="xl65" style="height:14.25pt"><span
              style="mso-spacerun:yes">&nbsp; </span>宝山区</td>
          <td class="xl66" x:num="16541"><span
              style="mso-spacerun:yes">&nbsp;</span>16
            541</td>
          <td class="xl66" x:num="1407"><span
              style="mso-spacerun:yes">&nbsp;</span>1 407</td>
          <td class="xl66" x:num="13134"><span
              style="mso-spacerun:yes">&nbsp;</span>13
            134</td>
          <td class="xl66" x:num="1114"><span
              style="mso-spacerun:yes">&nbsp;</span>1 114</td>
        </tr>
        <tr height="19" style="height:14.25pt">
          <td height="19" class="xl65" style="height:14.25pt"><span
              style="mso-spacerun:yes">&nbsp; </span>嘉定区</td>
          <td class="xl66" x:num="18546"><span
              style="mso-spacerun:yes">&nbsp;</span>18
            546</td>
          <td class="xl66" x:num="798"><span style="mso-spacerun:yes">&nbsp;
            </span>798</td>
          <td class="xl66" x:num="16410"><span
              style="mso-spacerun:yes">&nbsp;</span>16
            410</td>
          <td class="xl66" x:num="704"><span style="mso-spacerun:yes">&nbsp;
            </span>704</td>
        </tr>
        <tr height="19" style="height:14.25pt">
          <td height="19" class="xl65" style="height:14.25pt"><span
              style="mso-spacerun:yes">&nbsp; </span>金山区</td>
          <td class="xl66" x:num="4271"><span
              style="mso-spacerun:yes">&nbsp;</span>4 271</td>
          <td class="xl66" x:num="138"><span style="mso-spacerun:yes">&nbsp;
            </span>138</td>
          <td class="xl66" x:num="2727"><span
              style="mso-spacerun:yes">&nbsp;</span>2 727</td>
          <td class="xl66" x:num="90"><span style="mso-spacerun:yes">&nbsp;
            </span>90</td>
        </tr>
        <tr height="19" style="height:14.25pt">
          <td height="19" class="xl65" style="height:14.25pt"><span
              style="mso-spacerun:yes">&nbsp; </span>松江区</td>
          <td class="xl66" x:num="22548"><span
              style="mso-spacerun:yes">&nbsp;</span>22
            548</td>
          <td class="xl66" x:num="3929"><span
              style="mso-spacerun:yes">&nbsp;</span>3 929</td>
          <td class="xl66" x:num="16963"><span
              style="mso-spacerun:yes">&nbsp;</span>16
            963</td>
          <td class="xl66" x:num="3415"><span
              style="mso-spacerun:yes">&nbsp;</span>3 415</td>
        </tr>
        <tr height="19" style="height:14.25pt">
          <td height="19" class="xl65" style="height:14.25pt"><span
              style="mso-spacerun:yes">&nbsp; </span>青浦区</td>
          <td class="xl66" x:num="7904"><span
              style="mso-spacerun:yes">&nbsp;</span>7 904</td>
          <td class="xl66" x:num="552"><span style="mso-spacerun:yes">&nbsp;
            </span>552</td>
          <td class="xl66" x:num="6840"><span
              style="mso-spacerun:yes">&nbsp;</span>6 840</td>
          <td class="xl66" x:num="483"><span style="mso-spacerun:yes">&nbsp;
            </span>483</td>
        </tr>
        <tr height="19" style="height:14.25pt">
          <td height="19" class="xl65" style="height:14.25pt"><span
              style="mso-spacerun:yes">&nbsp; </span>奉贤区</td>
          <td class="xl66" x:num="4830"><span
              style="mso-spacerun:yes">&nbsp;</span>4 830</td>
          <td class="xl66" x:num="235"><span style="mso-spacerun:yes">&nbsp;
            </span>235</td>
          <td class="xl66" x:num="4719"><span
              style="mso-spacerun:yes">&nbsp;</span>4 719</td>
          <td class="xl66" x:num="172"><span style="mso-spacerun:yes">&nbsp;
            </span>172</td>
        </tr>
        <tr height="20" style="height:15.0pt">
          <td height="20" class="xl65" style="height:15.0pt"><span
              style="mso-spacerun:yes">&nbsp; </span>崇明区</td>
          <td class="xl66" x:num="2260"><span
              style="mso-spacerun:yes">&nbsp;</span>2 260</td>
          <td class="xl66" x:num="98"><span style="mso-spacerun:yes">&nbsp;
            </span>98</td>
          <td class="xl66" x:num="1906"><span
              style="mso-spacerun:yes">&nbsp;</span>1 906</td>
          <td class="xl66" x:num="62"><span style="mso-spacerun:yes">&nbsp;
            </span>62</td>
        </tr>
        <tr height="19" style="height:14.25pt">
          <td colspan="5" height="19" class="xl76" width="526"
            style="height:14.25pt;
    width:396pt"> </td>
        </tr>
      </tbody></table>


      <script>
        const area = [];

        const arearDom = document.getElementsByClassName('xl65')


      </script>

  </body></html>"""

# 各区人口流入流出
from bs4 import BeautifulSoup # type: ignore
import copy
  
#### 获取所有地区名称
# 使用BeautifulSoup解析HTML
soup = BeautifulSoup(html_doc, 'lxml')
# 查找class为"xl65"的<td>标签
td_tags = soup.find_all('td', class_='xl65')
# 提取<td>标签内的文本，注意strip()方法用来去除多余的空白字符
area_list = []
for td_tag in td_tags:
  areaText = td_tag.get_text().strip()
  area_list.append([areaText])



#### 获取所有地区每年迁入数据
td_nums = soup.find_all('td', class_='xl66')
area_flow_in = copy.deepcopy(area_list)
area_flow_out = copy.deepcopy(area_list)
for i in range(len(td_nums)):
  tmpNum = td_nums[i]['x:num']
  if i % 4 == 0 or i % 4 == 2:
    area_flow_in[i//4].append(tmpNum)
  else:
    area_flow_out[i//4].append(tmpNum)

print(f"""人口流入: \n{area_flow_in}""")
print(f"""人口流出: \n{area_flow_out}""")

import pandas as pd
import openpyxl

df = pd.DataFrame(area_flow_in, columns=['地区', '2021年', '2022年'])
excel_path = 'flowIn.xlsx'
df.to_excel(excel_path, index=False)


df = pd.DataFrame(area_flow_out, columns=['地区', '2021年', '2022年'])
excel_path = 'flowOut.xlsx'
df.to_excel(excel_path, index=False)